\documentclass[11pt]{exam}
\footer{}{\thepage}{} % avoid ``Page X''
\usepackage[left=0.7in, right=0.7in, top=0.8in, bottom=0.8in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage[all]{foreign}
\usepackage{amsmath,amsthm,amsfonts,amssymb,mathtools,bm}
\usepackage[low-sup]{subdepth} % alignment of sub and sup scripts
\usepackage{stackengine} % stacking matrix dimensions
\stackMath
\def\sss{\scriptstyle}
\setstackgap{L}{12pt}
\def\stacktype{L}

\usepackage{siunitx}

\usepackage[sc]{mathpazo}
%\usepackage{euscript}
\usepackage{float,booktabs,threeparttable,caption,subcaption,xcolor}
\usepackage[low-sup]{subdepth}
\usepackage{mathrsfs,dsfont}
\usepackage{graphicx}
\usepackage{enumitem}
\graphicspath{{figs/}}
\usepackage{natbib}
\usepackage{setspace}
\onehalfspacing
\usepackage{hyperref}
\usepackage[noabbrev,nameinlink,capitalise]{cleveref}
\hypersetup{colorlinks = true, urlcolor = blue, linkcolor = blue, citecolor = blue}

% avoid line breaks at binary operators and relation operators in inline math
\binoppenalty=10000 
\relpenalty=10000 

% spacing of align
\expandafter\def\expandafter\normalsize\expandafter{%
	\normalsize%
	\setlength\abovedisplayskip{8pt}%
	\setlength\belowdisplayskip{8pt}%
	\setlength\abovedisplayshortskip{-8pt}%
	\setlength\belowdisplayshortskip{2pt}%
}

\renewcommand{\questionshook}{\setlength{\itemsep}{0.06in}}
\renewcommand{\questionlabel}{\alph{question}.}
% referring to questions
\Crefformat{question}{#2Q#1#3}
\crefname{question}{question}{questions}
\Crefname{question}{Q}{Qs}

\printanswers

%% Build Directory Configuration
%%
%% To compile this document with auxiliary files (.aux, .log, .out, etc.) 
%% written to a separate build folder, use one of the following methods:
%%
%% Method 1: Using pdflatex directly
%%   pdflatex -output-directory=build Macro_I_PS5_Template.tex
%%   (Note: You may need to run this twice for cross-references)
%%
%% Method 2: Using latexmk (recommended)
%%   latexmk -pdf -auxdir=build -outdir=build Macro_I_PS5_Template.tex
%%
%% Method 3: Create a .latexmkrc file in the same directory with:
%%   $aux_dir = 'build';
%%   $out_dir = 'build';
%%   Then run: latexmk -pdf Macro_I_PS5_Template.tex
%%
%% The build folder will contain all auxiliary files, keeping your source
%% directory clean. The PDF output will also be placed in the build folder.

%% notation

% bold math
\newcommand{\bom}[1]{\bm{#1}}
\newcommand{\bX}{\bom{X}}
\newcommand{\bi}{\bom{\iota}}

% probability
\DeclareMathOperator*{\pp}{\mathbb{P}}

% expectation with round brackets
\NewDocumentCommand{\expect}{ e{^} s o >{\SplitArgument{1}{|}}m }{%
	\operatorname{\mathbb{E}}%     the expectation operator
	\IfValueT{#1}{{\!}^{#1}}% the measure of the expectation
	\IfBooleanTF{#2}{% *-variant
		\expectarg*{\expectvar#4}%
	}{% no *-variant
		\IfNoValueTF{#3}{% no optional argument
			\expectarg{\expectvar#4}%
		}{% optional argument
			\expectarg[#3]{\expectvar#4}%
		}%
	}%
}
\NewDocumentCommand{\expectvar}{mm}{%
	#1\IfValueT{#2}{\nonscript\mspace{1mu}\delimsize\vert\nonscript\mspace{1mu}#2}%
}
\DeclarePairedDelimiterX{\expectarg}[1]{(}{)}{#1}

% expectation with square brackets
\NewDocumentCommand{\expectsq}{ e{^} s o >{\SplitArgument{1}{|}}m }{%
	\operatorname{\mathbb{E}}%     the expectation operator
	\IfValueT{#1}{{\!}^{#1}}% the measure of the expectation
	\IfBooleanTF{#2}{% *-variant
		\expectargsq*{\expectvarsq#4}%
	}{% no *-variant
		\IfNoValueTF{#3}{% no optional argument
			\expectargsq{\expectvarsq#4}%
		}{% optional argument
			\expectargsq[#3]{\expectvarsq#4}%
		}%
	}%
}
\NewDocumentCommand{\expectvarsq}{mm}{%
	#1\IfValueT{#2}{\nonscript\mspace{1mu}\delimsize\vert\nonscript\mspace{1mu}#2}%
}
\DeclarePairedDelimiterX{\expectargsq}[1]{[}{]}{#1}

% covariance
\NewDocumentCommand{\cov}{ e{^} s o >{\SplitArgument{1}{|}}m }{%
	\operatorname{\mathbb{C}ov}%     the covariance operator
	\IfValueT{#1}{{\!}^{#1}}% the measure of the covariance
	\IfBooleanTF{#2}{% *-variant
		\covarg*{\covvar#4}%
	}{% no *-variant
		\IfNoValueTF{#3}{% no optional argument
			\covarg{\covvar#4}%
		}{% optional argument
			\covarg[#3]{\covvar#4}%
		}%
	}%
}
\NewDocumentCommand{\covvar}{mm}{%
	#1\IfValueT{#2}{\nonscript\mspace{1mu}\delimsize\vert\nonscript\mspace{1mu}#2}%
}
\DeclarePairedDelimiterX{\covarg}[1]{(}{)}{#1}

% covariance HAT
\NewDocumentCommand{\covhat}{ e{^} s o >{\SplitArgument{1}{|}}m }{%
	\operatorname{\ensuremath{\widehat{\mathbb{C}ov}}}%     the covariance operator
	\IfValueT{#1}{{\!}^{#1}}% the measure of the covariance
	\IfBooleanTF{#2}{% *-variant
		\covhatarg*{\covhatvar#4}%
	}{% no *-variant
		\IfNoValueTF{#3}{% no optional argument
			\covhatarg{\covhatvar#4}%
		}{% optional argument
			\covhatarg[#3]{\covhatvar#4}%
		}%
	}%
}
\NewDocumentCommand{\covhatvar}{mm}{%
	#1\IfValueT{#2}{\nonscript\mspace{1mu}\delimsize\vert\nonscript\mspace{1mu}#2}%
}
\DeclarePairedDelimiterX{\covhatarg}[1]{(}{)}{#1}

% variance
\NewDocumentCommand{\var}{ e{^} s o >{\SplitArgument{1}{|}}m }{%
	\operatorname{\mathbb{V}ar}%     the variance operator
	\IfValueT{#1}{{\!}^{#1}}% the measure of the variance
	\IfBooleanTF{#2}{% *-variant
		\vararg*{\varvar#4}%
	}{% no *-variant
		\IfNoValueTF{#3}{% no optional argument
			\vararg{\varvar#4}%
		}{% optional argument
			\vararg[#3]{\varvar#4}%
		}%
	}%
}
\NewDocumentCommand{\varvar}{mm}{%
	#1\IfValueT{#2}{\nonscript\mspace{1mu}\delimsize\vert\nonscript\mspace{1mu}#2}%
}
\DeclarePairedDelimiterX{\vararg}[1]{(}{)}{#1}


\DeclareMathOperator*{\trace}{tr}
\DeclareMathOperator*{\rank}{rank}

\newcommand{\duedate}{{\large\bfseries\color{red} Due date: Monday, 16th February, 23:59}}


\title{\vspace*{-4em}Macroeconomics I\\ Problem Set 5
	\ifprintanswers
	{\color{red}Solutions}
	\fi
\\	
{\normalsize Barcelona School of Economics, Spring 2026} \\
\duedate}

\author{Group members: AB, CD, EF, GH.}
\date{\today}

\begin{document}
\maketitle
\vspace*{-1em}

\section*{Submission Instructions}
Please submit a document with your answers to the course instructor via the designated submission platform by Monday, 16th February, 23:59 at the very latest. You can work in groups of up to four.

\section{Misallocation and Market Power}

In this whole exercise, we consider a closed economy, with a fixed population size. Assume the firm's production function is given by
\begin{align}
	Y_{i}=\varphi L_{i}^{\alpha}K_{i}^{\beta} \quad \text{with} \quad \alpha+\beta\le 1 \label{eq:production}
\end{align}
(Note: there is no $i$ index on $\varphi$ in the baseline case.)

\begin{questions}

\question Take the standard firm problem (static setting) with a continuum of identical atomistic firms and decreasing returns to scale technology. Assume firms are competitive on both their output and input markets. Describe the firm's problem and the first order conditions for capital and labor.
\begin{solution}
Each firm $i$ takes the output price (normalized to $1$), the wage $w$, and the rental rate $r$ as given, and solves
\[
\max_{L_{i},\,K_{i}}\;\pi_{i}=\varphi\, L_{i}^{\alpha}K_{i}^{\beta}-wL_{i}-rK_{i}.
\]
Since $\alpha+\beta\le 1$ the technology exhibits (weakly) decreasing returns to scale, so the objective is strictly concave in $(L_{i},K_{i})$ and the first-order conditions are both necessary and sufficient for a unique interior maximum.

The FOCs are:
\begin{align*}
\frac{\partial \pi_{i}}{\partial L_{i}}&:\quad \alpha\,\varphi\, L_{i}^{\alpha-1}K_{i}^{\beta}=w
\qquad\Longleftrightarrow\qquad MPL_{i}=w,\\[4pt]
\frac{\partial \pi_{i}}{\partial K_{i}}&:\quad \beta\,\varphi\, L_{i}^{\alpha}K_{i}^{\beta-1}=r
\qquad\Longleftrightarrow\qquad MPK_{i}=r.
\end{align*}
That is, each competitive firm hires labor and capital up to the point where their marginal products equal the respective factor prices.
\end{solution}

\question Define the following measure of misallocation of factors: for generic factor $x$, denote $\tau_{x}=\operatorname{var}(MPX^{*})$, where $\operatorname{var}(\cdot)$ is the variance across firms and $MPX$ is the marginal product of $x$. The $*$ indicates a value taken at the equilibrium. What is the level of misallocation in this model? Derive and argue your answer.
\begin{solution}
From the FOCs in part~(a), at the competitive equilibrium every firm $i$ satisfies
\[
MPL_{i}^{*}=\alpha\,\varphi\,(L_{i}^{*})^{\alpha-1}(K_{i}^{*})^{\beta}=w,
\qquad
MPK_{i}^{*}=\beta\,\varphi\,(L_{i}^{*})^{\alpha}(K_{i}^{*})^{\beta-1}=r.
\]
Because all firms are \emph{identical} (same $\varphi$, same technology) and face the same factor prices $w$ and $r$, they all choose the same input bundle $(L_{i}^{*},K_{i}^{*})$. Consequently the marginal products are the same constant across all firms:
\[
MPL_{i}^{*}=w\;\;\forall\,i,
\qquad
MPK_{i}^{*}=r\;\;\forall\,i.
\]
Since the marginal products are identical across firms, their cross-sectional variance is zero:
\[
\boxed{\tau_{L}=\operatorname{var}(MPL^{*})=0,\qquad \tau_{K}=\operatorname{var}(MPK^{*})=0.}
\]
There is \textbf{no misallocation} of factors. This is a direct consequence of the First Welfare Theorem: in a competitive equilibrium without distortions, the allocation of resources is Pareto efficient. Because all firms equalize their marginal products to common factor prices, no reallocation of inputs across firms could raise aggregate output.
\end{solution}

\question Assume now that firms are heterogeneous in productivity $\varphi_{i}$. Compute again $\tau_{x}$ for capital and labor and discuss your finding.
\begin{solution}
With heterogeneous productivity $\varphi_{i}$, each firm $i$ still takes $w$ and $r$ as given and maximizes
\[
\max_{L_{i},\,K_{i}}\;\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta}-wL_{i}-rK_{i}.
\]
The FOCs are:
\begin{align*}
\alpha\,\varphi_{i}\,L_{i}^{\alpha-1}K_{i}^{\beta}&=w \qquad\Longleftrightarrow\qquad MPL_{i}=w,\\
\beta\,\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta-1}&=r \qquad\Longleftrightarrow\qquad MPK_{i}=r.
\end{align*}
Even though $\varphi_{i}$ differs across firms, each firm \emph{still} equates its marginal product to the common factor price. At equilibrium, $MPL_{i}^{*}=w$ and $MPK_{i}^{*}=r$ for every firm $i$, regardless of the level of $\varphi_{i}$. Firms with higher $\varphi_{i}$ simply choose larger input bundles $(L_{i}^{*},K_{i}^{*})$, but the marginal products at the optimum are the same across all firms.

Therefore:
\[
\boxed{\tau_{L}=\operatorname{var}(MPL^{*})=0,\qquad \tau_{K}=\operatorname{var}(MPK^{*})=0.}
\]
\textbf{Discussion.} Introducing firm-level productivity heterogeneity does \emph{not} generate misallocation in a competitive economy. Competitive factor markets ensure that inputs flow to where their marginal product equals the market price, so marginal products are equalized across firms. More productive firms attract proportionally more capital and labor, but this is precisely the efficient allocation: any reallocation of inputs away from this equilibrium would \emph{lower} aggregate output. This result is again a manifestation of the First Welfare Theorem.
\end{solution}

\question Compute the optimal size of the firm and the associated profits. Discuss the implication of what you found in terms of efficiency of the allocation. In particular, discuss how your conclusions depend on whether $\alpha+\beta<1$ or $\alpha+\beta=1$.
\begin{solution}
From the FOCs of the firm with heterogeneous $\varphi_{i}$ (part~c) we can write
\[
wL_{i}=\alpha\,Y_{i},\qquad rK_{i}=\beta\,Y_{i},
\]
so $L_{i}=\frac{\alpha\,Y_{i}}{w}$ and $K_{i}=\frac{\beta\,Y_{i}}{r}$. Substituting into the production function $Y_{i}=\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta}$:
\[
Y_{i}=\varphi_{i}\left(\frac{\alpha\,Y_{i}}{w}\right)^{\!\alpha}\left(\frac{\beta\,Y_{i}}{r}\right)^{\!\beta}
=\varphi_{i}\,\frac{\alpha^{\alpha}\beta^{\beta}}{w^{\alpha}r^{\beta}}\,Y_{i}^{\alpha+\beta},
\]
which gives
\[
Y_{i}^{1-\alpha-\beta}=\varphi_{i}\,\frac{\alpha^{\alpha}\beta^{\beta}}{w^{\alpha}r^{\beta}}.
\]

\medskip
\textbf{Case 1: $\alpha+\beta<1$ (strictly decreasing returns to scale).}

The optimal output of firm $i$ is
\[
Y_{i}^{*}=\left(\varphi_{i}\,\frac{\alpha^{\alpha}\beta^{\beta}}{w^{\alpha}r^{\beta}}\right)^{\!\frac{1}{1-\alpha-\beta}},
\]
and the optimal input demands are
\[
L_{i}^{*}=\frac{\alpha}{w}\,Y_{i}^{*},\qquad K_{i}^{*}=\frac{\beta}{r}\,Y_{i}^{*}.
\]
Profits are
\[
\pi_{i}^{*}=Y_{i}^{*}-wL_{i}^{*}-rK_{i}^{*}=Y_{i}^{*}-\alpha\,Y_{i}^{*}-\beta\,Y_{i}^{*}=(1-\alpha-\beta)\,Y_{i}^{*}>0.
\]
Firm size (output, inputs, and profits) is uniquely determined and strictly increasing in $\varphi_{i}$: more productive firms are larger and earn higher profits.

\medskip
\textbf{Case 2: $\alpha+\beta=1$ (constant returns to scale).}

The equation becomes $Y_{i}^{0}=1=\varphi_{i}\,\frac{\alpha^{\alpha}\beta^{\beta}}{w^{\alpha}r^{\beta}}$, which is a condition on equilibrium prices $(w,r)$, \emph{not} on firm size. The profit function is linear in scale:
\[
\pi_{i}=Y_{i}-\alpha\,Y_{i}-\beta\,Y_{i}=(1-\alpha-\beta)\,Y_{i}=0.
\]
Profits are zero and firm size is \textbf{indeterminate}: any $(L_{i},K_{i})$ with
$K_{i}/L_{i}=\beta w/(\alpha r)$ is optimal. With heterogeneous $\varphi_{i}$,
equilibrium prices can satisfy the zero-profit condition for at most one value
of~$\varphi$, so only the most productive firms can operate; all others make
losses and exit.

\medskip
\textbf{Efficiency discussion.}
In both cases the competitive allocation is efficient (First Welfare Theorem): marginal products are equalized across firms and there is no misallocation ($\tau_{L}=\tau_{K}=0$).

Under DRS ($\alpha+\beta<1$), positive profits $(1-\alpha-\beta)Y_{i}^{*}$ represent the return to the implicit ``entrepreneurial'' or fixed factor that generates decreasing returns at the firm level. Multiple heterogeneous firms coexist in equilibrium, each at their uniquely determined efficient scale.

Under CRS ($\alpha+\beta=1$), zero profits and indeterminate firm size mean that the distribution of production across firms is irrelevant for aggregate efficiency---any allocation of inputs that equates marginal products is equally efficient. However, with heterogeneous $\varphi_{i}$, the model cannot sustain the coexistence of firms with different productivities, so only the most productive firms survive.
\end{solution}

\question Now let's allow for market power. We can keep this very general by simply having the firm optimize over an inverse demand schedule $p(c_{i})$ which responds to its decisions. Assume that the function $p(\cdot)$ is the same for all firms. Write down the firm's maximization problem, compute the measure of misallocation and discuss your finding. Is your finding the same if we assume productivity to be the same at all firms $(\varphi_{i}=\varphi)$?
\begin{solution}
With market power, each firm $i$ recognises that its output choice affects the price it receives through the inverse demand function $p(\cdot)$. The firm solves
\[
\max_{L_{i},\,K_{i}}\;\pi_{i}=p(Y_{i})\,Y_{i}-wL_{i}-rK_{i},
\qquad Y_{i}=\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta}.
\]
Using the chain rule ($\partial Y_{i}/\partial L_{i}=\alpha Y_{i}/L_{i}$, etc.), the FOCs are:
\begin{align*}
\frac{\partial \pi_{i}}{\partial L_{i}}&:\quad
\bigl[p'(Y_{i})\,Y_{i}+p(Y_{i})\bigr]\,\alpha\,\varphi_{i}\,L_{i}^{\alpha-1}K_{i}^{\beta}=w,\\[4pt]
\frac{\partial \pi_{i}}{\partial K_{i}}&:\quad
\bigl[p'(Y_{i})\,Y_{i}+p(Y_{i})\bigr]\,\beta\,\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta-1}=r.
\end{align*}
Define the \emph{marginal revenue} of firm $i$ as
\[
MR_{i}\;\equiv\;p'(Y_{i})\,Y_{i}+p(Y_{i})
\;=\;p(Y_{i})\!\left(1-\frac{1}{\varepsilon_{i}}\right),
\]
where $\varepsilon_{i}\equiv -\frac{p(Y_{i})}{p'(Y_{i})\,Y_{i}}>1$ is the (absolute) price elasticity of demand faced by firm~$i$. The \emph{markup} is $\mu_{i}\equiv p(Y_{i})/MR_{i}=\varepsilon_{i}/(\varepsilon_{i}-1)>1$.

The FOCs can then be written compactly as
\[
MR_{i}\cdot MPL_{i}=w,
\qquad
MR_{i}\cdot MPK_{i}=r,
\]
so the equilibrium marginal products are
\[
MPL_{i}^{*}=\frac{w}{MR_{i}^{*}}=\frac{\mu_{i}^{*}\,w}{p(Y_{i}^{*})},
\qquad
MPK_{i}^{*}=\frac{r}{MR_{i}^{*}}=\frac{\mu_{i}^{*}\,r}{p(Y_{i}^{*})}.
\]

\medskip
\textbf{Heterogeneous productivity $(\varphi_{i})$.}
With different $\varphi_{i}$, firms produce different output levels $Y_{i}^{*}$. Because the demand function $p(\cdot)$ is generally non-isoelastic, the elasticity $\varepsilon_{i}$ and hence the markup $\mu_{i}$ vary with $Y_{i}^{*}$. Consequently, $MR_{i}^{*}$ differs across firms, and so do the physical marginal products:
\[
\boxed{\tau_{L}=\operatorname{var}(MPL^{*})>0,\qquad \tau_{K}=\operatorname{var}(MPK^{*})>0.}
\]
\emph{Market power combined with firm heterogeneity generates misallocation}: physical marginal products are no longer equalized across firms, so a reallocation of inputs could raise aggregate output.

\medskip
\textbf{Homogeneous productivity $(\varphi_{i}=\varphi)$.}
If all firms are identical, the equilibrium is symmetric: every firm chooses the same $(L^{*},K^{*},Y^{*})$, faces the same price $p^{*}=p(Y^{*})$, the same elasticity $\varepsilon^{*}$, and the same markup $\mu^{*}$. Therefore $MPL_{i}^{*}$ and $MPK_{i}^{*}$ are the same for all $i$, giving
\[
\tau_{L}=0,\qquad \tau_{K}=0.
\]
There is \textbf{no cross-sectional misallocation}. However, market power still causes each firm to produce below the socially efficient level (level inefficiency), a distortion that the variance-based measure $\tau_{x}$ does not capture.
\end{solution}

\question In the same economy of point (e), compute a new measure of misallocation $\tilde{\tau}_{x}$ defined as the variance of the marginal \emph{revenue} product of input $x$ (at the equilibrium). The marginal revenue product is defined as: $MRPX\equiv\partial r(\cdot)/\partial x$, where $r(\cdot)$ is the revenue function: $r(y_{i})=p_{i}(y_{i})y_{i}$. Discuss your findings.
\begin{solution}
The revenue function of firm $i$ is $r(Y_{i})=p(Y_{i})\,Y_{i}$. The marginal revenue products of labor and capital are
\begin{align*}
MRPL_{i}&\equiv\frac{\partial\,r(Y_{i})}{\partial L_{i}}
=\frac{d\,[p(Y_{i})\,Y_{i}]}{d\,Y_{i}}\cdot\frac{\partial Y_{i}}{\partial L_{i}}
=\bigl[p'(Y_{i})\,Y_{i}+p(Y_{i})\bigr]\cdot\alpha\,\varphi_{i}\,L_{i}^{\alpha-1}K_{i}^{\beta}
=MR_{i}\cdot MPL_{i},\\[4pt]
MRPK_{i}&\equiv\frac{\partial\,r(Y_{i})}{\partial K_{i}}
=MR_{i}\cdot MPK_{i}.
\end{align*}

But from the first-order conditions derived in part~(e), profit maximization requires exactly
\[
MR_{i}\cdot MPL_{i}=w,\qquad MR_{i}\cdot MPK_{i}=r,
\]
for \emph{every} firm~$i$. Therefore, at the equilibrium:
\[
MRPL_{i}^{*}=w\;\;\forall\,i,\qquad MRPK_{i}^{*}=r\;\;\forall\,i.
\]

Since the marginal revenue products are identical across all firms, the new misallocation measure is
\[
\boxed{\tilde{\tau}_{L}=\operatorname{var}(MRPL^{*})=0,\qquad \tilde{\tau}_{K}=\operatorname{var}(MRPK^{*})=0.}
\]
This result holds \emph{regardless} of whether firms are heterogeneous in productivity~$\varphi_{i}$ or not.

\medskip
\textbf{Discussion.} The equalization of marginal revenue products is a direct consequence of profit maximization with common factor prices. Every firm---no matter its size, productivity, or markup---hires inputs up to the point where the marginal \emph{revenue} contribution equals the factor price. The measure $\tilde{\tau}_{x}=0$ tells us that no firm has a \emph{private} incentive to deviate, but it says nothing about whether the allocation is socially efficient. In particular, it is silent about the level inefficiency (underproduction) caused by markups and, as we saw in part~(e), about the cross-sectional misallocation of \emph{physical} marginal products.
\end{solution}

\question Discuss these two measures. Are they good measures of misallocation? How do they relate to one another (and when are they equal)? What can we infer about the efficiency of the allocation in this economy (with the assumptions of point (e))?
\begin{solution}
\textbf{Relationship between the two measures.}
For any input $x$, the marginal revenue product and the physical marginal product are related by
\[
MRPX_{i}=MR_{i}\cdot MPX_{i}=\frac{p(Y_{i})}{\mu_{i}}\cdot MPX_{i}.
\]
The two measures therefore satisfy
\[
\tilde{\tau}_{x}=\operatorname{var}(MRPX^{*})
=\operatorname{var}\!\bigl(MR_{i}^{*}\cdot MPX_{i}^{*}\bigr),
\qquad
\tau_{x}=\operatorname{var}(MPX^{*}).
\]
They \textbf{coincide} when $MR_{i}=p(Y_{i})$ for every firm, i.e.\ when $\mu_{i}=1$ (firms are price-takers). This is exactly the competitive case of parts~(a)--(d), where both measures equal zero.

\medskip
\textbf{Are they good measures of misallocation?}

\emph{Physical-MP measure $(\tau_{x})$.}
This measure captures \emph{cross-sectional} (allocative) inefficiency: when $\tau_{x}>0$, aggregate output could be increased by reallocating inputs from firms with low marginal products to firms with high marginal products. However, $\tau_{x}$ is blind to \emph{level} inefficiency. Even when $\varphi_{i}=\varphi$ so that $\tau_{x}=0$, every firm still produces below the socially efficient quantity because of the markup. Hence $\tau_{x}=0$ does \emph{not} imply that the allocation is efficient.

\emph{Revenue-MP measure $(\tilde{\tau}_{x})$.}
This measure is always zero in an economy where all firms face common factor prices and maximize profits. It merely confirms that no firm has a private incentive to deviate---a necessary condition for equilibrium, not for efficiency. It detects neither cross-sectional nor level inefficiency. Therefore, $\tilde{\tau}_{x}$ is a \textbf{poor} measure of misallocation in the presence of market power.

\medskip
\textbf{What can we infer about efficiency?}

In the economy of part~(e) with heterogeneous $\varphi_{i}$ and market power:
\begin{enumerate}[label=(\roman*)]
\item \textbf{Cross-sectional inefficiency} ($\tau_{x}>0$): because markups $\mu_{i}$ vary across firms (for a general demand function), physical marginal products are not equalized. Inputs are misallocated---firms with higher markups use too few inputs relative to the social optimum.
\item \textbf{Level inefficiency}: every firm restricts output below the competitive/socially optimal level. Aggregate output is below the first-best, even if all firms had the same markup.
\end{enumerate}
In summary, $\tau_{x}$ is the more informative measure of the two---it correctly flags cross-sectional misallocation---but a full welfare assessment requires comparing actual firm sizes to the socially optimal ones, as we do in part~(h).
\end{solution}

\question Derive the socially optimal and market-induced firm size. What can you conclude about the level and cross-section efficiency of this economy?
\begin{solution}
Assume $\alpha+\beta<1$ throughout (strictly decreasing returns to scale) so that firm size is uniquely determined.

\medskip
\textbf{Market-induced firm size.}
From the FOCs in part~(e), $MR_{i}\cdot\alpha\,Y_{i}/L_{i}=w$ and $MR_{i}\cdot\beta\,Y_{i}/K_{i}=r$, so
\[
wL_{i}=\alpha\,\frac{p_{i}}{\mu_{i}}\,Y_{i},\qquad rK_{i}=\beta\,\frac{p_{i}}{\mu_{i}}\,Y_{i},
\]
where $p_{i}=p(Y_{i})$ and $\mu_{i}=p_{i}/MR_{i}$. Substituting $L_{i}$ and $K_{i}$ into the production function $Y_{i}=\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta}$ and solving:
\[
\boxed{Y_{i}^{M}=\left(\varphi_{i}\,\frac{\alpha^{\alpha}\beta^{\beta}}{w^{\alpha}r^{\beta}}\left(\frac{p_{i}}{\mu_{i}}\right)^{\!\alpha+\beta}\right)^{\!\frac{1}{1-\alpha-\beta}}.}
\]

\medskip
\textbf{Socially optimal firm size.}
A social planner maximizes total surplus from each variety. The surplus from firm~$i$ is $\int_{0}^{Y_{i}}p(q)\,dq-wL_{i}-rK_{i}$. The FOCs equate the \emph{price} (marginal valuation) to the value of the marginal product:
\[
p(Y_{i})\cdot\alpha\,\varphi_{i}\,L_{i}^{\alpha-1}K_{i}^{\beta}=w,\qquad
p(Y_{i})\cdot\beta\,\varphi_{i}\,L_{i}^{\alpha}K_{i}^{\beta-1}=r,
\]
which give $wL_{i}=\alpha\,p_{i}\,Y_{i}$ and $rK_{i}=\beta\,p_{i}\,Y_{i}$. Following the same algebra:
\[
\boxed{Y_{i}^{S}=\left(\varphi_{i}\,\frac{\alpha^{\alpha}\beta^{\beta}}{w^{\alpha}r^{\beta}}\,p_{i}^{\,\alpha+\beta}\right)^{\!\frac{1}{1-\alpha-\beta}}.}
\]

\medskip
\textbf{Comparison.}
The ratio of market to socially optimal output is
\[
\frac{Y_{i}^{M}}{Y_{i}^{S}}=\mu_{i}^{\,-\frac{\alpha+\beta}{1-\alpha-\beta}}<1,
\]
since $\mu_{i}>1$. This yields two conclusions:

\begin{enumerate}[label=(\roman*)]
\item \textbf{Level inefficiency.} Every firm produces strictly less than the social optimum: $Y_{i}^{M}<Y_{i}^{S}$ for all~$i$. Market power causes underproduction across the board. This is the standard deadweight loss of monopoly pricing.

\item \textbf{Cross-sectional efficiency.}
\begin{itemize}
\item If the markup is \emph{constant} across firms ($\mu_{i}=\mu$ for all~$i$, as would be the case with a constant-elasticity demand), the ratio $Y_{i}^{M}/Y_{i}^{S}=\mu^{-(\alpha+\beta)/(1-\alpha-\beta)}$ is the same for every firm. All firms are scaled down uniformly, so \emph{relative} firm sizes are the same as under the planner. There is \textbf{no cross-sectional misallocation}---only level inefficiency.
\item If the markup \emph{varies} across firms ($\mu_{i}\neq\mu_{j}$ for $i\neq j$, which generically occurs with a non-isoelastic demand and heterogeneous~$\varphi_{i}$), firms with higher markups are disproportionately too small relative to the social optimum. The relative size distribution is distorted, generating \textbf{both level and cross-sectional inefficiency}.
\end{itemize}
\end{enumerate}

\medskip
\textbf{Summary.} Market power always causes level inefficiency (underproduction). Whether it also distorts the cross-sectional allocation of inputs depends on whether markups are constant or variable across firms. For a general (non-isoelastic) demand function $p(\cdot)$, markups vary with firm size, so both types of inefficiency are present.
\end{solution}

\question Consider the following graphs of the distribution of marginal product of capital and labor (see Figures~\ref{fig:mpk} and~\ref{fig:mpl}). As background, we obtained these distributions from firm level data by doing the following steps:
\begin{itemize}
	\item We estimated the industry production function to obtain estimates of $\alpha$ and $\beta$, the output elasticities of capital and labor.
	\item We used firm sales, number of workers, and capital stock to compute:
	\begin{align}
		MPL_{i}&=\beta\frac{\text{sales}_{i}}{\#\text{workers}_{i}} \\
		MPK_{i}&=\alpha\frac{\text{sales}_{i}}{\text{capital stock}_{i}}
	\end{align}
\end{itemize}
What can we conclude from these distributions about the level of misallocation in this economy? Are these measures, computed as described above, good proxies for misallocation? What assumptions are we making that might be violated in the data?
\begin{solution}
% Your solution here
\end{solution}

\question So far we have only assumed that firms are heterogeneous and have some market power. Consider now the specific preferences given by a CES aggregator. How do your previous conclusions change?
\begin{solution}
% Your solution here
\end{solution}

\question Assume now that in this CES economy, firms compete in monopolistic competition. How do your previous conclusions change?
\begin{solution}
% Your solution here
\end{solution}

\end{questions}

\subsection*{Figures}

%% Place mpk_distribution.pdf and mpl_distribution.pdf in the figs/ subdirectory.
\begin{figure}[H]
	\centering
	\IfFileExists{figs/mpk_distribution.pdf}{%
		\includegraphics[scale=0.9,keepaspectratio]{mpk_distribution.pdf}%
	}{%
		\fbox{\parbox{0.8\textwidth}{\centering\small [Figure 1: MPK distribution --- add mpk\_distribution.pdf to figs/]}}%
	}
	\caption{Distribution of Marginal Product of Capital (MPK) across firms.}
	\label{fig:mpk}
\end{figure}

\begin{figure}[H]
	\centering
	\IfFileExists{figs/mpl_distribution.pdf}{%
		\includegraphics[scale=0.9,keepaspectratio]{mpl_distribution.pdf}%
	}{%
		\fbox{\parbox{0.8\textwidth}{\centering\small [Figure 2: MPL distribution --- add mpl\_distribution.pdf to figs/]}}%
	}
	\caption{Distribution of Marginal Product of Labor (MPL) across firms.}
	\label{fig:mpl}
\end{figure}

\end{document}
